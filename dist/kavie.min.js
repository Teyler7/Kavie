/*!
    Kavie - knockout observable validator
    Author: Matthew Nitschke
    License: MIT (http://www.opensource.org/licenses/mit-license.php)
    Version: 0.6.0
*/
function KavieSection(){var e=this;e.observables=[],e.children={},e.validate=!0}!function(e){e.sections={},e.isValid=function(e){for(var a=!0,n=t(e),r=0;r<n.length;r++)n[r].startValidation(),a&&n[r].hasError()&&(a=!1);return a},e.isSectionValid=function(a){var t=e.sections[a],n=!0;if(ko.unwrap(t.validate)){for(var r=Object.keys(t.children),i=0;i<r.length;i++){var o=e.isSectionValid(r[i]);o||(n=!1)}var s=e.isValid(t.observables);s||(n=!1)}else e.deactivateSection(a);return n},e.deactivate=function(e){for(var a=t(e),n=0;n<a.length;n++)a[n].stopValidation()},e.deactivateSection=function(a){for(var t=e.sections[a],n=Object.keys(t.children),r=0;r<n.length;r++)e.deactivateSection(n[r]);e.deactivate(t.observables)},e.addVariableValidation=function(a,t){var n=e.sections[a];n||(n=e.sections[a]=new KavieSection),n.validate=t},e.addSectionChild=function(a,t){var n=e.sections[a];n||(n=e.sections[a]=new KavieSection),n.children[t]=new KavieSection};var a=function(e){return e.hasOwnProperty("hasError")},t=function(e){var t=[];if(e&&e.hasOwnProperty("observables")&&(e=e.observables),e)for(var n=Object.keys(e),r=0;r<n.length;r++)a(e[n[r]])&&t.push(e[n[r]]);return t};e.validatorFunctions={required:{validator:function(e,a){return!e||n(a)},message:"This field is required"},numeric:{validator:function(e,a){return!e||!n(a)||!isNaN(parseFloat(a))&&isFinite(a)},message:"Please enter a numeric value"},maxLength:{validator:function(e,a){return!a||a.length<=e},message:"Please enter a value less than or equal to {propVal}"},minLength:{validator:function(e,a){return!!a&&a.length>=e},message:"Please enter a value greater than or equal to {propVal}"},matches:function(e,a){return ko.unwrap(e)==ko.unwrap(a)},date:{validator:function(e,a){return!e||!n(a)||a.length>=8&&a.length<=10&&"Invalid Date"!=new Date(a)},message:"Please enter a valid date"},birthdate:{validator:function(e,a){if(e&&n(a)){if(!Kavie.validatorFunctions.date.validator(e,a))return!1;var t=new Date(a);if(t>new Date)return!1;var r=new Date;return r.setFullYear(r.getFullYear()-120),!(t<r)}return!0},message:"Please enter a valid birthdate"},phone:{validator:function(e,a){return!e||!n(a)||!!a.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},message:"Please enter a valid phone number"},email:{validator:function(e,a){return!e||!n(a)||!!a.match(/^(?:(?:[\w`~!#$%^&*\-=+;:{}'|,?\/]+(?:(?:\.(?:"(?:\\?[\w`~!#$%^&*\-=+;:{}'|,?\/\.()<>\[\] @]|\\"|\\\\)*"|[\w`~!#$%^&*\-=+;:{}'|,?\/]+))*\.[\w`~!#$%^&*\-=+;:{}'|,?\/]+)?)|(?:"(?:\\?[\w`~!#$%^&*\-=+;:{}'|,?\/\.()<>\[\] @]|\\"|\\\\)+"))@(?:[a-zA-Z\d\-]+(?:\.[a-zA-Z\d\-]+)*|\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])$/)},message:"Please enter a valid email address"},regexPattern:function(e,a){return null!==a.toString().match(e)}};var n=function(e){return!(null==e||0===e.length)}}(this.Kavie=this.Kavie||{}),ko.extenders.kavie=function(e,a){function t(a){var t=e.rules;for(key in t)for(funcKey in Kavie.validatorFunctions)if(key==funcKey){var n;n="function"==typeof Kavie.validatorFunctions[funcKey]?Kavie.validatorFunctions[funcKey]:Kavie.validatorFunctions[funcKey].validator;var r=n(t[key],a);if(!r)return Kavie.validatorFunctions[funcKey].message?e.errorMessage(Kavie.validatorFunctions[funcKey].message.replace("{propVal}",t[key])):e.errorMessage(""),void e.hasError(!0);e.errorMessage("")}e.hasError(!1)}var n=a;return e.hasError=ko.observable(),e.errorMessage=ko.observable(),n.section&&(Kavie.sections[n.section]||(Kavie.sections[n.section]=new KavieSection),Kavie.sections[n.section].observables.push(e),n.section=""),e.rules=n,e.startValidation=function(){e.subscription=e.subscribe(t),t(e())},e.stopValidation=function(){e.subscription&&e.subscription.dispose(),e.hasError(!1),e.errorMessage("")},e};