/*!
    Kavie - knockout observable validator
    Author: Matthew Nitschke
    License: MIT (http://www.opensource.org/licenses/mit-license.php)
    Version: 0.5.0
*/
function KavieSection(){var e=this;e.observables=[],e.children={},e.validate=!0}!function(e){e.sections={},e.isValid=function(e){for(var a=!0,t=n(e),r=0;r<t.length;r++)t[r].startValidation(),a&&t[r].hasError()&&(a=!1);return a},e.isSectionValid=function(a){var n=e.sections[a],t=!0;if(ko.unwrap(n.validate)){for(var r=Object.keys(n.children),i=0;i<r.length;i++){var o=e.isSectionValid(r[i]);o||(t=!1)}var s=e.isValid(n.observables);s||(t=!1)}else e.deactivateSection(a);return t},e.deactivate=function(e){for(var a=n(e),t=0;t<a.length;t++)a[t].stopValidation()},e.deactivateSection=function(a){for(var n=e.sections[a],t=Object.keys(n.children),r=0;r<t.length;r++)e.deactivateSection(t[r]);e.deactivate(n.observables)},e.addVariableValidation=function(a,n){var t=e.sections[a];t||(t=e.sections[a]=new KavieSection),t.validate=n},e.addSectionChild=function(a,n){var t=e.sections[a];t||(t=e.sections[a]=new KavieSection),t.children[n]=new KavieSection};var a=function(e){return e.hasOwnProperty("hasError")},n=function(e){var n=[];if(e&&e.hasOwnProperty("observables")&&(e=e.observables),e)for(var t=Object.keys(e),r=0;r<t.length;r++)a(e[t[r]])&&n.push(e[t[r]]);return n};e.validatorFunctions={required:{validator:function(e,a){return!e||t(a)},message:"This field is required"},numeric:{validator:function(e,a){return!e||!t(a)||!isNaN(parseFloat(a))&&isFinite(a)},message:"Please enter a numeric value"},maxLength:{validator:function(e,a){return!a||a.length<=e},message:"Please enter a value less than or equal to {propVal}"},minLength:{validator:function(e,a){return!!a&&a.length>=e},message:"Please enter a value greater than or equal to {propVal}"},matches:function(e,a){return ko.unwrap(e)==ko.unwrap(a)},date:{validator:function(e,a){return!e||!t(a)||a.length>=8&&a.length<=10&&"Invalid Date"!=new Date(a)},message:"Please enter a valid date"},birthdate:{validator:function(e,a){if(e&&t(a)){if(!Kavie.validatorFunctions.date(e,a))return!1;var n=new Date(a);if(n>new Date)return!1;var r=new Date;return r.setFullYear(r.getFullYear()-120),!(n<r)}return!0},message:"Please enter a valid birthdate"},phone:{validator:function(e,a){return!e||!t(a)||!!a.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},message:"Please enter a valid phone number"},email:{validator:function(e,a){return!e||!t(a)||!!a.match(/^(?:(?:[\w`~!#$%^&*\-=+;:{}'|,?\/]+(?:(?:\.(?:"(?:\\?[\w`~!#$%^&*\-=+;:{}'|,?\/\.()<>\[\] @]|\\"|\\\\)*"|[\w`~!#$%^&*\-=+;:{}'|,?\/]+))*\.[\w`~!#$%^&*\-=+;:{}'|,?\/]+)?)|(?:"(?:\\?[\w`~!#$%^&*\-=+;:{}'|,?\/\.()<>\[\] @]|\\"|\\\\)+"))@(?:[a-zA-Z\d\-]+(?:\.[a-zA-Z\d\-]+)*|\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])$/)},message:"Please enter a valid email address"},regexPattern:function(e,a){return null!==a.toString().match(e)}};var t=function(e){return!(null==e||0===e.length)}}(this.Kavie=this.Kavie||{}),ko.extenders.kavie=function(e,a){function n(a){var n=e.rules;for(key in n)for(funcKey in Kavie.validatorFunctions)if(key==funcKey){var t;t="function"==typeof Kavie.validatorFunctions[funcKey]?Kavie.validatorFunctions[funcKey]:Kavie.validatorFunctions[funcKey].validator;var r=t(n[key],a);if(!r)return Kavie.validatorFunctions[funcKey].message?e.errorMessage(Kavie.validatorFunctions[funcKey].message.replace("{propVal}",n[key])):e.errorMessage(""),void e.hasError(!0);e.errorMessage("")}e.hasError(!1)}var t=a;return e.hasError=ko.observable(),e.errorMessage=ko.observable(),t.section&&(Kavie.sections[t.section]||(Kavie.sections[t.section]=new KavieSection),Kavie.sections[t.section].observables.push(e),t.section=""),e.rules=t,e.startValidation=function(){e.subscription=e.subscribe(n),n(e())},e.stopValidation=function(){e.subscription&&e.subscription.dispose(),e.hasError(!1),e.errorMessage("")},e};